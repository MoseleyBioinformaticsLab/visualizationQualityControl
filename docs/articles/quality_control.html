<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quality Control Example • visualizationQualityControl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quality Control Example">
<meta property="og:description" content="visualizationQualityControl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visualizationQualityControl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.105</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ici-kendalltau.html">Information-Content-Informed Kendall Tau Correlation</a>
    </li>
    <li>
      <a href="../articles/pca_testing.html">PCA Testing</a>
    </li>
    <li>
      <a href="../articles/quality_control.html">Quality Control Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="quality_control_files/header-attrs-2.3/header-attrs.js"></script><script src="quality_control_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quality Control Example</h1>
                        <h4 class="author">Robert M Flight</h4>
            
            <h4 class="date">2020-10-08 17:26:29</h4>
      
      
      <div class="hidden name"><code>quality_control.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette shows how the various functions in this package can be used for basic quality control, in addition to advocating a particular workflow for examining experimental data prior to analysis. These steps consist of:</p>
<ul>
<li>Principal components analysis</li>
<li>Correlation heatmap</li>
<li>Median correlation</li>
<li>Feature outliers</li>
</ul>
<p>In all of the examples, we will compare and contrast a dataset that is composed of two different conditions, and the same dataset wherein two samples have had their class labels switched by mistake, and how the visualizations above can illustrate potential problems.</p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">visualizationQualityControl</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="kw">grp_exp_data</span>)
<span class="kw">exp_data</span> <span class="op">&lt;-</span> <span class="kw">grp_exp_data</span><span class="op">$</span><span class="kw">data</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="kw">exp_data</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">exp_data</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">exp_data</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="kw">exp_data</span>)))

<span class="kw">sample_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(id = <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">exp_data</span>), class = <span class="kw">grp_exp_data</span><span class="op">$</span><span class="kw">class</span>)
<span class="kw">sample_classes</span> <span class="op">&lt;-</span> <span class="kw">sample_info</span><span class="op">$</span><span class="kw">class</span>

<span class="kw">mix_data</span> <span class="op">&lt;-</span> <span class="kw">exp_data</span>
<span class="kw">mix_data</span>[, <span class="fl">5</span>] <span class="op">&lt;-</span> <span class="kw">exp_data</span>[, <span class="fl">19</span>]
<span class="kw">mix_data</span>[, <span class="fl">19</span>] <span class="op">&lt;-</span> <span class="kw">exp_data</span>[, <span class="fl">5</span>]
</pre></div>
<p>The data used here are from a simulated experiment, where there are two classes of samples. 1000 features measured, across 20 samples from 2 groups, with 10 in each group.</p>
<p>The actual values we are going to use are in <code>exp_data</code>. The classes of samples are defined in <code>sample_classes</code>. We will also create a version of the data that has two samples completely switched by accident, labels and all, in <code>mix_data</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw">exp_data</span>)
</pre></div>
<pre><code>##  num [1:1000, 1:20] 0.833 3.826 15.87 0.842 1.87 ...
##  - attr(*, "dimnames")=List of 2
##   ..$ : chr [1:1000] "f1" "f2" "f3" "f4" ...
##   ..$ : chr [1:20] "s1" "s2" "s3" "s4" ...</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">exp_data</span>[<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>]
</pre></div>
<pre><code>##            s1       s2        s3        s4       s5
## f1  0.8326984 1.795155 0.9698029  0.000000 0.000000
## f2  3.8262483 3.103851 1.9064043  3.446350 6.217429
## f3 15.8695770 7.078666 5.6856675 11.138222 7.580068
## f4  0.8422794 0.000000 1.8026048  0.171272 0.000000
## f5  1.8696869 7.724530 3.9550344  1.919573 1.087596</code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">sample_info</span>
</pre></div>
<pre><code>##     id class
## 1   s1  grp1
## 2   s2  grp1
## 3   s3  grp1
## 4   s4  grp1
## 5   s5  grp1
## 6   s6  grp1
## 7   s7  grp1
## 8   s8  grp1
## 9   s9  grp1
## 10 s10  grp1
## 11 s11  grp2
## 12 s12  grp2
## 13 s13  grp2
## 14 s14  grp2
## 15 s15  grp2
## 16 s16  grp2
## 17 s17  grp2
## 18 s18  grp2
## 19 s19  grp2
## 20 s20  grp2</code></pre>
</div>
<div id="data-transformation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-transformation" class="anchor"></a>Data Transformation</h2>
<p>Before we do anything else, we need to transform the data. This is because this and other -omics data frequently have a distribution and error structure that many statistical methods will completely choke on, or at least give you incorrect results.</p>
<p><strong>Make sure to ask</strong> if data has been transformed in any way!</p>
<p>Here I will show what the raw and transformed data looks like.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">exp_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">exp_data</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">exp_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">s1</span>, y = <span class="kw">s2</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(title = <span class="st">"Raw Data"</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/raw_plot-1.png" width="768"></p>
<p>Notice the dispersion in the values as the actual values increase. Most statistical methods don’t like this.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">log_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="kw">exp_data</span>)
</pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">log_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">log_data</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">log_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">s1</span>, y = <span class="kw">s2</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(title = <span class="st">"Log Transform"</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/log_plot-1.png" width="768"></p>
<p>But, lots of other methods don’t deal well with <code>NA</code> or <code>Inf</code> values, which is what you get when you do a log-transform on negative or zero values. There are a couple of solutions:</p>
<ul>
<li>If have negatives, add the most negative + small offset</li>
<li>If have zeros, use <code>log1p</code> to handle zero and small values</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">log1_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span>(<span class="kw">exp_data</span>)

<span class="kw">small_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="kw">exp_data</span>[<span class="kw">exp_data</span> != <span class="fl">0</span>]) <span class="op">/</span> <span class="fl">100</span>
<span class="kw">log2_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span>(<span class="kw">exp_data</span> <span class="op">+</span> <span class="kw">small_value</span>)
</pre></div>
<p>Most of the methods in this package can handle the presence of <code>NA</code> or <code>Inf</code>, except for the principal components analysis (PCA). Because we have physical data, the lowest value should be zero. Therefore we can use <code>log1p</code>, which will keep the zeros as zeros. Alternatively, we could use <code>log1p</code> for PCA, and <code>log</code> for the correlations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">log_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span>(<span class="kw">exp_data</span>)
<span class="kw">log_mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span>(<span class="kw">mix_data</span>)
</pre></div>
</div>
<div id="principal-components-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#principal-components-analysis" class="anchor"></a>Principal Components Analysis</h2>
<p>As a first step, we will use principal components analysis (PCA) to decompose the data. PCA is trying to find linear combinations of the original variables that account for the maximum amount of variance, and then finding the next combination that is orthogonal to the first, and so on and so on. It is extemely useful for confirming that the largest source of variance is the biological one, and for examining if any confounds can explain some sources of variance.</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">pca_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">log_data</span>), center = <span class="fl">TRUE</span>)
<span class="kw">pca_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">log_mix</span>), center = <span class="fl">TRUE</span>)
</pre></div>
<div id="visualize-them" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-them" class="anchor"></a>Visualize Them</h3>
<p>To visualize the data, we plot the scores. If we want to know how much a PC contributes to the variances, we can get a summary of them using <code>visqc_score_contributions</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">gd_scores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">pca_data</span><span class="op">$</span><span class="kw">x</span>), <span class="kw">sample_info</span>)
<span class="kw">gd_pca</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">gd_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">PC1</span>, y = <span class="kw">PC2</span>, color = <span class="kw">class</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Good Data"</span>)
<span class="kw">gd_pca</span>
</pre></div>
<p><img src="quality_control_files/figure-html/plot_good-1.png" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="fu"><a href="../reference/visqc_score_contributions.html">visqc_score_contributions</a></span>(<span class="kw">pca_data</span><span class="op">$</span><span class="kw">x</span>))
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">pc</th>
<th align="right">variance</th>
<th align="right">percent</th>
<th align="right">cumulative</th>
<th align="left">labels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PC1</td>
<td align="right">630.300641</td>
<td align="right">0.7474956</td>
<td align="right">0.7474956</td>
<td align="left">PC1 (75%)</td>
</tr>
<tr class="even">
<td align="left">PC2</td>
<td align="right">15.260619</td>
<td align="right">0.0180981</td>
<td align="right">0.7655937</td>
<td align="left">PC2 (1.8%)</td>
</tr>
<tr class="odd">
<td align="left">PC3</td>
<td align="right">14.393039</td>
<td align="right">0.0170692</td>
<td align="right">0.7826629</td>
<td align="left">PC3 (1.7%)</td>
</tr>
<tr class="even">
<td align="left">PC4</td>
<td align="right">13.998044</td>
<td align="right">0.0166008</td>
<td align="right">0.7992637</td>
<td align="left">PC4 (1.7%)</td>
</tr>
<tr class="odd">
<td align="left">PC5</td>
<td align="right">13.624605</td>
<td align="right">0.0161579</td>
<td align="right">0.8154216</td>
<td align="left">PC5 (1.6%)</td>
</tr>
<tr class="even">
<td align="left">PC6</td>
<td align="right">13.191010</td>
<td align="right">0.0156437</td>
<td align="right">0.8310653</td>
<td align="left">PC6 (1.6%)</td>
</tr>
<tr class="odd">
<td align="left">PC7</td>
<td align="right">12.649098</td>
<td align="right">0.0150010</td>
<td align="right">0.8460663</td>
<td align="left">PC7 (1.5%)</td>
</tr>
<tr class="even">
<td align="left">PC8</td>
<td align="right">12.395460</td>
<td align="right">0.0147002</td>
<td align="right">0.8607665</td>
<td align="left">PC8 (1.5%)</td>
</tr>
<tr class="odd">
<td align="left">PC9</td>
<td align="right">11.904228</td>
<td align="right">0.0141176</td>
<td align="right">0.8748841</td>
<td align="left">PC9 (1.4%)</td>
</tr>
<tr class="even">
<td align="left">PC10</td>
<td align="right">11.803515</td>
<td align="right">0.0139982</td>
<td align="right">0.8888823</td>
<td align="left">PC10 (1.4%)</td>
</tr>
<tr class="odd">
<td align="left">PC11</td>
<td align="right">11.425450</td>
<td align="right">0.0135498</td>
<td align="right">0.9024322</td>
<td align="left">PC11 (1.4%)</td>
</tr>
<tr class="even">
<td align="left">PC12</td>
<td align="right">11.294834</td>
<td align="right">0.0133949</td>
<td align="right">0.9158271</td>
<td align="left">PC12 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">PC13</td>
<td align="right">10.735845</td>
<td align="right">0.0127320</td>
<td align="right">0.9285591</td>
<td align="left">PC13 (1.3%)</td>
</tr>
<tr class="even">
<td align="left">PC14</td>
<td align="right">10.627450</td>
<td align="right">0.0126035</td>
<td align="right">0.9411626</td>
<td align="left">PC14 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">PC15</td>
<td align="right">10.585936</td>
<td align="right">0.0125542</td>
<td align="right">0.9537168</td>
<td align="left">PC15 (1.3%)</td>
</tr>
<tr class="even">
<td align="left">PC16</td>
<td align="right">10.338576</td>
<td align="right">0.0122609</td>
<td align="right">0.9659777</td>
<td align="left">PC16 (1.2%)</td>
</tr>
<tr class="odd">
<td align="left">PC17</td>
<td align="right">10.188966</td>
<td align="right">0.0120835</td>
<td align="right">0.9780612</td>
<td align="left">PC17 (1.2%)</td>
</tr>
<tr class="even">
<td align="left">PC18</td>
<td align="right">9.646507</td>
<td align="right">0.0114401</td>
<td align="right">0.9895013</td>
<td align="left">PC18 (1.1%)</td>
</tr>
<tr class="odd">
<td align="left">PC19</td>
<td align="right">8.852683</td>
<td align="right">0.0104987</td>
<td align="right">1.0000000</td>
<td align="left">PC19 (1%)</td>
</tr>
<tr class="even">
<td align="left">PC20</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
<td align="left">PC20 (0.0000000000000000000000000000041%)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="kw">bad_scores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw">pca_mixed</span><span class="op">$</span><span class="kw">x</span>), <span class="kw">sample_info</span>)
<span class="kw">bad_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">bad_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">PC1</span>, y = <span class="kw">PC2</span>, color = <span class="kw">class</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Bad Data"</span>)
<span class="kw">bad_pca</span>
</pre></div>
<p><img src="quality_control_files/figure-html/plot_bad-1.png" width="768"></p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="fu"><a href="../reference/visqc_score_contributions.html">visqc_score_contributions</a></span>(<span class="kw">pca_mixed</span><span class="op">$</span><span class="kw">x</span>))
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">pc</th>
<th align="right">variance</th>
<th align="right">percent</th>
<th align="right">cumulative</th>
<th align="left">labels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PC1</td>
<td align="right">630.300641</td>
<td align="right">0.7474956</td>
<td align="right">0.7474956</td>
<td align="left">PC1 (75%)</td>
</tr>
<tr class="even">
<td align="left">PC2</td>
<td align="right">15.260619</td>
<td align="right">0.0180981</td>
<td align="right">0.7655937</td>
<td align="left">PC2 (1.8%)</td>
</tr>
<tr class="odd">
<td align="left">PC3</td>
<td align="right">14.393039</td>
<td align="right">0.0170692</td>
<td align="right">0.7826629</td>
<td align="left">PC3 (1.7%)</td>
</tr>
<tr class="even">
<td align="left">PC4</td>
<td align="right">13.998044</td>
<td align="right">0.0166008</td>
<td align="right">0.7992637</td>
<td align="left">PC4 (1.7%)</td>
</tr>
<tr class="odd">
<td align="left">PC5</td>
<td align="right">13.624605</td>
<td align="right">0.0161579</td>
<td align="right">0.8154216</td>
<td align="left">PC5 (1.6%)</td>
</tr>
<tr class="even">
<td align="left">PC6</td>
<td align="right">13.191010</td>
<td align="right">0.0156437</td>
<td align="right">0.8310653</td>
<td align="left">PC6 (1.6%)</td>
</tr>
<tr class="odd">
<td align="left">PC7</td>
<td align="right">12.649098</td>
<td align="right">0.0150010</td>
<td align="right">0.8460663</td>
<td align="left">PC7 (1.5%)</td>
</tr>
<tr class="even">
<td align="left">PC8</td>
<td align="right">12.395460</td>
<td align="right">0.0147002</td>
<td align="right">0.8607665</td>
<td align="left">PC8 (1.5%)</td>
</tr>
<tr class="odd">
<td align="left">PC9</td>
<td align="right">11.904228</td>
<td align="right">0.0141176</td>
<td align="right">0.8748841</td>
<td align="left">PC9 (1.4%)</td>
</tr>
<tr class="even">
<td align="left">PC10</td>
<td align="right">11.803515</td>
<td align="right">0.0139982</td>
<td align="right">0.8888823</td>
<td align="left">PC10 (1.4%)</td>
</tr>
<tr class="odd">
<td align="left">PC11</td>
<td align="right">11.425450</td>
<td align="right">0.0135498</td>
<td align="right">0.9024322</td>
<td align="left">PC11 (1.4%)</td>
</tr>
<tr class="even">
<td align="left">PC12</td>
<td align="right">11.294834</td>
<td align="right">0.0133949</td>
<td align="right">0.9158271</td>
<td align="left">PC12 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">PC13</td>
<td align="right">10.735845</td>
<td align="right">0.0127320</td>
<td align="right">0.9285591</td>
<td align="left">PC13 (1.3%)</td>
</tr>
<tr class="even">
<td align="left">PC14</td>
<td align="right">10.627450</td>
<td align="right">0.0126035</td>
<td align="right">0.9411626</td>
<td align="left">PC14 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">PC15</td>
<td align="right">10.585936</td>
<td align="right">0.0125542</td>
<td align="right">0.9537168</td>
<td align="left">PC15 (1.3%)</td>
</tr>
<tr class="even">
<td align="left">PC16</td>
<td align="right">10.338576</td>
<td align="right">0.0122609</td>
<td align="right">0.9659777</td>
<td align="left">PC16 (1.2%)</td>
</tr>
<tr class="odd">
<td align="left">PC17</td>
<td align="right">10.188966</td>
<td align="right">0.0120835</td>
<td align="right">0.9780612</td>
<td align="left">PC17 (1.2%)</td>
</tr>
<tr class="even">
<td align="left">PC18</td>
<td align="right">9.646507</td>
<td align="right">0.0114401</td>
<td align="right">0.9895013</td>
<td align="left">PC18 (1.1%)</td>
</tr>
<tr class="odd">
<td align="left">PC19</td>
<td align="right">8.852683</td>
<td align="right">0.0104987</td>
<td align="right">1.0000000</td>
<td align="left">PC19 (1%)</td>
</tr>
<tr class="even">
<td align="left">PC20</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
<td align="left">PC20 (0.000000000000000000000000000007%)</td>
</tr>
</tbody>
</table>
<p>Note in this case <strong>PC1</strong> contains a large proportion of variance, and separates the samples very well. The PCA plots rarely look this good in practice!</p>
</div>
</div>
<div id="correlation-heatmap" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-heatmap" class="anchor"></a>Correlation Heatmap</h2>
<p>Correlation heatmaps show much of the same information as the PCA plots, but in a different way. Note that what we are calculating are <strong>all pairwise sample-sample</strong> correlations. In each sample-sample correlation, we calculate the correlation using the non-zero feature values.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="kw">s1_s2_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span>(<span class="kw">log_data</span>[,<span class="fl">1</span>], <span class="kw">log_data</span>[,<span class="fl">2</span>])
<span class="kw">s1_s2_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%.4f"</span>, <span class="kw">s1_s2_cor</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">log_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">s1</span>, y = <span class="kw">s2</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(title = <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"R = "</span>, <span class="kw">s1_s2_val</span>))
</pre></div>
<p><img src="quality_control_files/figure-html/sample1_sample2_cor-1.png" width="480"></p>
<div id="calculate-correlations" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-correlations" class="anchor"></a>Calculate Correlations</h3>
<p>All pairwise correlations should be calculated using either the <code>globally_it_weighted_pairwise_correlation</code> or <code>locally_it_weighted_pairwise_correlation</code> functions. These functions calculate a correlation where we remove missing or zero values in either sample, and in addition, weights the correlations by the information shared between the samples, as well as their consistency, that is how many shared present and missing values there are between them. Note that we take the transpose of the data, because this function assumes that data are organized with <em>features</em> as <em>columns</em> and <em>samples</em> as <em>rows</em>. Also, because we used <code>log1p</code> to transform the data, we make sure to remove the zeros, corresponding to missing data. A <code>log</code> transform would make them <code>-Inf</code> or <code>NaN</code>, and they should be removed automatically.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="kw">data_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globally_it_weighted_pairwise_correlation.html">globally_it_weighted_pairwise_correlation</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">log_data</span>), exclude_0 = <span class="fl">TRUE</span>)
</pre></div>
<p>This returns a list with some useful information, the actual correlations in <code>cor</code>, the number of points in each correlation in <code>count</code>, and which points pass the various filters in <code>keep</code>. We are really only interested in <code>cor</code> in this case.</p>
<p>We can also check that we did the right correlations by looking at the dimensions of the matrix, in this case we expect a 20 <em>by</em> 20 matrix.</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="kw">data_cor</span> <span class="op">&lt;-</span> <span class="kw">data_cor</span><span class="op">$</span><span class="kw">cor</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="kw">data_cor</span>)
</pre></div>
<pre><code>## [1] 20 20</code></pre>
<p>We also do the same for our <strong>mixed-up</strong> data.</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="kw">mix_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/globally_it_weighted_pairwise_correlation.html">globally_it_weighted_pairwise_correlation</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">log_mix</span>))<span class="op">$</span><span class="kw">cor</span>
</pre></div>
</div>
<div id="reorder-correlations" class="section level3">
<h3 class="hasAnchor">
<a href="#reorder-correlations" class="anchor"></a>Reorder Correlations</h3>
<p>To make the heatmap more useful, we also do clustering within each of the <strong>sample classes</strong> and reorder the correlations, this highlights sub-groups within classes as well as potential outliers.</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="kw">data_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity_reorderbyclass.html">similarity_reorderbyclass</a></span>(<span class="kw">data_cor</span>, <span class="kw">sample_info</span>[, <span class="st">"class"</span>, drop = <span class="fl">FALSE</span>],
                                        transform = <span class="st">"sub_1"</span>)
<span class="kw">mix_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similarity_reorderbyclass.html">similarity_reorderbyclass</a></span>(<span class="kw">mix_cor</span>, <span class="kw">sample_info</span>[, <span class="st">"class"</span>, drop = <span class="fl">FALSE</span>],
                                       transform = <span class="st">"sub_1"</span>)
</pre></div>
</div>
<div id="color-by-class" class="section level3">
<h3 class="hasAnchor">
<a href="#color-by-class" class="anchor"></a>Color by Class</h3>
<p>We also want to color them by their class.</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="kw">data_legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_group_colors.html">generate_group_colors</a></span>(<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">data_legend</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grp1"</span>, <span class="st">"grp2"</span>)

<span class="kw">row_data</span> <span class="op">&lt;-</span> <span class="kw">sample_info</span>[, <span class="st">"class"</span>, drop = <span class="fl">FALSE</span>]
<span class="kw">row_annotation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(class = <span class="kw">data_legend</span>)
</pre></div>
</div>
<div id="map-correlation-to-color" class="section level3">
<h3 class="hasAnchor">
<a href="#map-correlation-to-color" class="anchor"></a>Map Correlation to Color</h3>
<p>Correlation values are mapped to colors using the <code>colorRamp2</code> function, by specifying the range of correlations, and what colors to map them to. Here the <code>viridis</code> color-scale is used because it is perceptually uniform and is good for those suffering from various types of color blindness. Other choices might be <strong>black -&gt; white</strong>, or the other color maps in the <code>viridis</code> package. More information about <code>viridis</code> is available <a href="http://bids.github.io/colormap/">here</a>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/sjmgarnier/viridis">viridis</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/jokergoo/circlize">circlize</a></span>)
<span class="kw">colormap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.2</span>, <span class="fl">1</span>, length.out = <span class="fl">20</span>), <span class="kw">viridis</span>::<span class="fu"><a href="https://rdrr.io/pkg/viridisLite/man/viridis.html">viridis</a></span>(<span class="fl">20</span>))
</pre></div>
</div>
<div id="heatmap" class="section level3">
<h3 class="hasAnchor">
<a href="#heatmap" class="anchor"></a>Heatmap!</h3>
<p>Finally we can make the heatmaps!</p>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="fu"><a href="../reference/visqc_heatmap.html">visqc_heatmap</a></span>(<span class="kw">data_cor</span>, <span class="kw">colormap</span>, <span class="st">"Good Data"</span>, row_color_data = <span class="kw">row_data</span>,
              row_color_list = <span class="kw">row_annotation</span>, col_color_data = <span class="kw">row_data</span>,
              col_color_list = <span class="kw">row_annotation</span>, row_order = <span class="kw">data_order</span><span class="op">$</span><span class="kw">indices</span>,
              column_order = <span class="kw">data_order</span><span class="op">$</span><span class="kw">indices</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/heatmap1-1.png" width="480"></p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="fu"><a href="../reference/visqc_heatmap.html">visqc_heatmap</a></span>(<span class="kw">mix_cor</span>, <span class="kw">colormap</span>, <span class="st">"Bad Data"</span>, row_color_data = <span class="kw">row_data</span>,
              row_color_list = <span class="kw">row_annotation</span>, col_color_data = <span class="kw">row_data</span>,
              col_color_list = <span class="kw">row_annotation</span>, row_order = <span class="kw">mix_order</span><span class="op">$</span><span class="kw">indices</span>,
              column_order = <span class="kw">mix_order</span><span class="op">$</span><span class="kw">indices</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/heatmap2-1.png" width="480"></p>
<p>Note in the second example, <strong>s5</strong> and <strong>s19</strong> look odd.</p>
</div>
</div>
<div id="median-correlation" class="section level2">
<h2 class="hasAnchor">
<a href="#median-correlation" class="anchor"></a>Median Correlation</h2>
<p>Lets also calculate the median correlation within each class.</p>
<div id="good" class="section level3">
<h3 class="hasAnchor">
<a href="#good" class="anchor"></a>Good</h3>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="kw">data_medcor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/median_correlations.html">median_correlations</a></span>(<span class="kw">data_cor</span>, <span class="kw">sample_info</span><span class="op">$</span><span class="kw">class</span>)
</pre></div>
<p>And plot it using facets in <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data_medcor</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">sample_id</span>, y = <span class="kw">med_cor</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw">.</span> <span class="op">~</span> <span class="kw">sample_class</span>, scales = <span class="st">"free"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Good Data"</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/plot_med_good-1.png" width="480"></p>
</div>
<div id="bad" class="section level3">
<h3 class="hasAnchor">
<a href="#bad" class="anchor"></a>Bad</h3>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="kw">mix_medcor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/median_correlations.html">median_correlations</a></span>(<span class="kw">mix_cor</span>, <span class="kw">sample_info</span><span class="op">$</span><span class="kw">class</span>)
</pre></div>
<p>Plot it!</p>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mix_medcor</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">sample_id</span>, y = <span class="kw">med_cor</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw">.</span> <span class="op">~</span> <span class="kw">sample_class</span>, scales = <span class="st">"free"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Bad Dat"</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/plot_med_mix-1.png" width="480"></p>
</div>
</div>
<div id="proportion-of-outlier-features" class="section level2">
<h2 class="hasAnchor">
<a href="#proportion-of-outlier-features" class="anchor"></a>Proportion of Outlier Features</h2>
<p>For every feature (the rows in our matrix), within each <strong>sample-class</strong>, calculate the <strong>trimmed</strong> (remove the <em>x</em> highest and lowest values) <em>mean</em> and <em>sd</em>, which features are outside a given number of <em>sd’s</em>, and then calculate the proportion of outliers in each sample. Samples with a deviated proportion of outliers should be examined more closely.</p>
<p>If you are using <strong>metabolomics</strong> data with a large number of zeros, you probably want to ignore zeros.</p>
<div id="good-1" class="section level3">
<h3 class="hasAnchor">
<a href="#good-1" class="anchor"></a>Good</h3>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="kw">data_outlier</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outlier_fraction.html">outlier_fraction</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">log_data</span>), <span class="kw">sample_info</span><span class="op">$</span><span class="kw">class</span>, remove_0 = <span class="fl">TRUE</span>)
</pre></div>
<p>Plot them!</p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">data_outlier</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">sample</span>, y = <span class="kw">frac</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw">.</span> <span class="op">~</span> <span class="kw">class</span>, scales = <span class="st">"free"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Good Data"</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/plot_good_outliers-1.png" width="480"></p>
</div>
<div id="bad-1" class="section level3">
<h3 class="hasAnchor">
<a href="#bad-1" class="anchor"></a>Bad</h3>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="kw">mix_outlier</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outlier_fraction.html">outlier_fraction</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw">mix_data</span>), <span class="kw">sample_info</span><span class="op">$</span><span class="kw">class</span>, remove_0 = <span class="fl">TRUE</span>)
</pre></div>
<p>Plot them.</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mix_outlier</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">sample</span>, y = <span class="kw">frac</span>)) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="kw">.</span> <span class="op">~</span> <span class="kw">class</span>, scales = <span class="st">"free"</span>) <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Mix Data"</span>)
</pre></div>
<p><img src="quality_control_files/figure-html/plot_mixoutliers-1.png" width="480"></p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>Hopefully this has shown how you can use the various tools to examine your high-througput -omics data for potential problems.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert M Flight, Hunter NB Moseley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
