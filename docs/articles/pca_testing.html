<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PCA Testing • visualizationQualityControl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PCA Testing">
<meta property="og:description" content="visualizationQualityControl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visualizationQualityControl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pca_testing.html">PCA Testing</a>
    </li>
    <li>
      <a href="../articles/quality_control.html">Quality Control Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pca_testing_files/header-attrs-2.3/header-attrs.js"></script><script src="pca_testing_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PCA Testing</h1>
            
      
      
      <div class="hidden name"><code>pca_testing.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">visualizationQualityControl</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">patchwork</span>)</pre></body></html></div>
<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>Principal components analysis (PCA) and related methods are very useful data decomposition methods. However, when one has hundreds or thousands of variables as many -omics methods do, any information beyond just examining PC1 and PC2 is often lost.</p>
<p>However, there may be opportunities to examine the association of sample scores on each principal component to see if they are associated with any particular sample variable of interest. Following that, we can test the loadings of the variables on that PC to see if any are significantly associated with that PC. These variables may describe something important about the data that doesn’t just come from statistically significant differential differences.</p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p>The data we will use is completely artificial, in that the differences are extreme and completely made up. We have 20 samples, 10 in each class, and 1000 variables.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"grp_exp_data"</span>)
<span class="no">data_matrix</span> <span class="kw">=</span> <span class="no">grp_exp_data</span>$<span class="no">data</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">data_matrix</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">data_matrix</span>)))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">data_matrix</span>) <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">data_matrix</span>)))

<span class="no">sample_info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">id</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">data_matrix</span>), <span class="kw">class</span> <span class="kw">=</span> <span class="no">grp_exp_data</span>$<span class="no">class</span>)

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">data_matrix</span>)
<span class="co">#&gt; [1] 1000   20</span></pre></body></html></div>
<p>This data has a proportional variance structure, where the variance increases with the value. We can see this by examining a plot of two columns in raw and log-transformed values.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">data_df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">data_matrix</span>)
<span class="no">log_df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span>(<span class="no">data_df</span>)

<span class="no">raw_plot</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">data_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">s1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">s2</span>)) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()
<span class="no">log_plot</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">log_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">s1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">s2</span>)) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()
<span class="no">raw_plot</span> + <span class="no">log_plot</span></pre></body></html></div>
<p><img src="pca_testing_files/figure-html/check_proportional-1.png" width="700"></p>
</div>
<div id="pca" class="section level2">
<h2 class="hasAnchor">
<a href="#pca" class="anchor"></a>PCA</h2>
<p>We will use the log-transformed values, because PCA doesn’t do well with proportional variance data.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">log_pca</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">log_df</span>), <span class="kw">center</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>We can summarize the variances of each principal component.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">log_variances</span> <span class="kw">=</span> <span class="fu"><a href="../reference/visqc_score_contributions.html">visqc_score_contributions</a></span>(<span class="no">log_pca</span>$<span class="no">x</span>)
<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">log_variances</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">pc</th>
<th align="right">variance</th>
<th align="right">percent</th>
<th align="right">cumulative</th>
<th align="left">labels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PC1</td>
<td align="right">630.300641</td>
<td align="right">0.7474956</td>
<td align="right">0.7474956</td>
<td align="left">PC1 (75%)</td>
</tr>
<tr class="even">
<td align="left">PC2</td>
<td align="right">15.260619</td>
<td align="right">0.0180981</td>
<td align="right">0.7655937</td>
<td align="left">PC2 (1.8%)</td>
</tr>
<tr class="odd">
<td align="left">PC3</td>
<td align="right">14.393039</td>
<td align="right">0.0170692</td>
<td align="right">0.7826629</td>
<td align="left">PC3 (1.7%)</td>
</tr>
<tr class="even">
<td align="left">PC4</td>
<td align="right">13.998044</td>
<td align="right">0.0166008</td>
<td align="right">0.7992637</td>
<td align="left">PC4 (1.7%)</td>
</tr>
<tr class="odd">
<td align="left">PC5</td>
<td align="right">13.624605</td>
<td align="right">0.0161579</td>
<td align="right">0.8154216</td>
<td align="left">PC5 (1.6%)</td>
</tr>
<tr class="even">
<td align="left">PC6</td>
<td align="right">13.191010</td>
<td align="right">0.0156437</td>
<td align="right">0.8310653</td>
<td align="left">PC6 (1.6%)</td>
</tr>
<tr class="odd">
<td align="left">PC7</td>
<td align="right">12.649098</td>
<td align="right">0.0150010</td>
<td align="right">0.8460663</td>
<td align="left">PC7 (1.5%)</td>
</tr>
<tr class="even">
<td align="left">PC8</td>
<td align="right">12.395460</td>
<td align="right">0.0147002</td>
<td align="right">0.8607665</td>
<td align="left">PC8 (1.5%)</td>
</tr>
<tr class="odd">
<td align="left">PC9</td>
<td align="right">11.904228</td>
<td align="right">0.0141176</td>
<td align="right">0.8748841</td>
<td align="left">PC9 (1.4%)</td>
</tr>
<tr class="even">
<td align="left">PC10</td>
<td align="right">11.803515</td>
<td align="right">0.0139982</td>
<td align="right">0.8888823</td>
<td align="left">PC10 (1.4%)</td>
</tr>
<tr class="odd">
<td align="left">PC11</td>
<td align="right">11.425450</td>
<td align="right">0.0135498</td>
<td align="right">0.9024322</td>
<td align="left">PC11 (1.4%)</td>
</tr>
<tr class="even">
<td align="left">PC12</td>
<td align="right">11.294834</td>
<td align="right">0.0133949</td>
<td align="right">0.9158271</td>
<td align="left">PC12 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">PC13</td>
<td align="right">10.735845</td>
<td align="right">0.0127320</td>
<td align="right">0.9285591</td>
<td align="left">PC13 (1.3%)</td>
</tr>
<tr class="even">
<td align="left">PC14</td>
<td align="right">10.627450</td>
<td align="right">0.0126035</td>
<td align="right">0.9411626</td>
<td align="left">PC14 (1.3%)</td>
</tr>
<tr class="odd">
<td align="left">PC15</td>
<td align="right">10.585936</td>
<td align="right">0.0125542</td>
<td align="right">0.9537168</td>
<td align="left">PC15 (1.3%)</td>
</tr>
<tr class="even">
<td align="left">PC16</td>
<td align="right">10.338576</td>
<td align="right">0.0122609</td>
<td align="right">0.9659777</td>
<td align="left">PC16 (1.2%)</td>
</tr>
<tr class="odd">
<td align="left">PC17</td>
<td align="right">10.188966</td>
<td align="right">0.0120835</td>
<td align="right">0.9780612</td>
<td align="left">PC17 (1.2%)</td>
</tr>
<tr class="even">
<td align="left">PC18</td>
<td align="right">9.646507</td>
<td align="right">0.0114401</td>
<td align="right">0.9895013</td>
<td align="left">PC18 (1.1%)</td>
</tr>
<tr class="odd">
<td align="left">PC19</td>
<td align="right">8.852683</td>
<td align="right">0.0104987</td>
<td align="right">1.0000000</td>
<td align="left">PC19 (1%)</td>
</tr>
<tr class="even">
<td align="left">PC20</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
<td align="right">1.0000000</td>
<td align="left">PC20 (0.0000000000000000000000000000041%)</td>
</tr>
</tbody>
</table>
<p>And we can add the scores to the sample info so we can plot them by sample type.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">log_scores</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">log_pca</span>$<span class="no">x</span>), <span class="no">sample_info</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">log_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">PC1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">PC2</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="no">class</span>)) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>()</pre></body></html></div>
<p><img src="pca_testing_files/figure-html/add_scores-1.png" width="700"></p>
<p>Great, our <code>class</code> variable is definitely associated with PC1. What if there was some variable we were interested in knowing if there was a PC associated with it?</p>
</div>
<div id="test-pcs" class="section level2">
<h2 class="hasAnchor">
<a href="#test-pcs" class="anchor"></a>Test PCs</h2>
<p>The only one here should be PC1, but lets go through and test them anyway.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">pc_stats</span> <span class="kw">=</span> <span class="fu"><a href="../reference/visqc_test_pca_scores.html">visqc_test_pca_scores</a></span>(<span class="no">log_pca</span>$<span class="no">x</span>, <span class="no">sample_info</span>, <span class="st">"class"</span>)

<span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="no">pc_stats</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="left">PC</th>
<th align="left">variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.196857e+04</td>
<td align="right">1.196857e+04</td>
<td align="right">3.015770e+04</td>
<td align="right">0.0000000</td>
<td align="left">PC1</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">3.780000e-05</td>
<td align="right">3.780000e-05</td>
<td align="right">2.300000e-06</td>
<td align="right">0.9987946</td>
<td align="left">PC2</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">7.243800e-03</td>
<td align="right">7.243800e-03</td>
<td align="right">4.768000e-04</td>
<td align="right">0.9828191</td>
<td align="left">PC3</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.084890e-02</td>
<td align="right">1.084890e-02</td>
<td align="right">7.343000e-04</td>
<td align="right">0.9786802</td>
<td align="left">PC4</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.150000e-05</td>
<td align="right">1.150000e-05</td>
<td align="right">8.000000e-07</td>
<td align="right">0.9992956</td>
<td align="left">PC5</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">7.713200e-03</td>
<td align="right">7.713200e-03</td>
<td align="right">5.540000e-04</td>
<td align="right">0.9814812</td>
<td align="left">PC6</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.605300e-03</td>
<td align="right">1.605300e-03</td>
<td align="right">1.202000e-04</td>
<td align="right">0.9913719</td>
<td align="left">PC7</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">0.9999533</td>
<td align="left">PC8</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.384000e-04</td>
<td align="right">1.384000e-04</td>
<td align="right">1.100000e-05</td>
<td align="right">0.9973883</td>
<td align="left">PC9</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">5.684000e-04</td>
<td align="right">5.684000e-04</td>
<td align="right">4.560000e-05</td>
<td align="right">0.9946852</td>
<td align="left">PC10</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.231200e-02</td>
<td align="right">1.231200e-02</td>
<td align="right">1.020900e-03</td>
<td align="right">0.9748619</td>
<td align="left">PC11</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">5.503900e-03</td>
<td align="right">5.503900e-03</td>
<td align="right">4.617000e-04</td>
<td align="right">0.9830942</td>
<td align="left">PC12</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">2.510000e-04</td>
<td align="right">2.510000e-04</td>
<td align="right">2.220000e-05</td>
<td align="right">0.9962966</td>
<td align="left">PC13</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">2.671100e-03</td>
<td align="right">2.671100e-03</td>
<td align="right">2.381000e-04</td>
<td align="right">0.9878581</td>
<td align="left">PC14</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">1.366700e-03</td>
<td align="right">1.366700e-03</td>
<td align="right">1.223000e-04</td>
<td align="right">0.9912975</td>
<td align="left">PC15</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">2.072800e-02</td>
<td align="right">2.072800e-02</td>
<td align="right">1.899600e-03</td>
<td align="right">0.9657156</td>
<td align="left">PC16</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">5.379520e-02</td>
<td align="right">5.379520e-02</td>
<td align="right">5.003300e-03</td>
<td align="right">0.9443896</td>
<td align="left">PC17</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">2.221000e-04</td>
<td align="right">2.221000e-04</td>
<td align="right">2.180000e-05</td>
<td align="right">0.9963248</td>
<td align="left">PC18</td>
<td align="left">class</td>
</tr>
<tr class="odd">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">3.670000e-05</td>
<td align="right">3.670000e-05</td>
<td align="right">3.900000e-06</td>
<td align="right">0.9984416</td>
<td align="left">PC19</td>
<td align="left">class</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">1</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">9.185785e-01</td>
<td align="right">0.3505460</td>
<td align="left">PC20</td>
<td align="left">class</td>
</tr>
</tbody>
</table>
<p>As this is an artificial data-set, we expect that only PC1 is going to come back with something significant. We can double check the ANOVA results by plotting the scores in one-dimension as well.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">log_scores</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">PC1</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">class</span>)) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">position</span> <span class="kw">=</span> <span class="st">"identity"</span>)</pre></body></html></div>
<p><img src="pca_testing_files/figure-html/plot_single-1.png" width="700"></p>
<p>Again, this is a contrived example, so things separate really, really well.</p>
</div>
<div id="test-loadings" class="section level2">
<h2 class="hasAnchor">
<a href="#test-loadings" class="anchor"></a>Test Loadings</h2>
<p>We can also run a statistical test on the loadings for each variable on each PC. The way this works is to construct a <strong>null</strong> distribution of loadings from all of the other variables in all of the other PCs outside of the current one being tested. We will test both PC1 and PC2 here, because we don’t really expect that there should be that many on PC2. Note that for a large number of variables, this will take some time, because a slightly different null is created for each variable by excluding that variables loadings in the other PCs.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">loading_sig</span> <span class="kw">=</span> <span class="fu"><a href="../reference/visqc_test_pca_loadings.html">visqc_test_pca_loadings</a></span>(<span class="no">log_pca</span>$<span class="no">rotation</span>, <span class="kw">test_columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>), <span class="kw">progress</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="kw pkg">purrr</span><span class="kw ns">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span>(<span class="no">loading_sig</span>, ~ <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">.x</span>$<span class="no">p.value</span> <span class="kw">&lt;=</span> <span class="fl">0.05</span>))
<span class="co">#&gt; PC1 PC2 </span>
<span class="co">#&gt;  57  51</span></pre></body></html></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert M Flight.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
