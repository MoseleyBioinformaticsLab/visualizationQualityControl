<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="to avoid spurious visualization problems, it is useful in a heatmap visualization
to reorder the samples within each sample class. This function uses 
hierarchical clustering and dendsort to sort entries in a distance matrix."><title>reorder by sample class — similarity_reorderbyclass • visualizationQualityControl</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="reorder by sample class — similarity_reorderbyclass"><meta property="og:description" content="to avoid spurious visualization problems, it is useful in a heatmap visualization
to reorder the samples within each sample class. This function uses 
hierarchical clustering and dendsort to sort entries in a distance matrix."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">visualizationQualityControl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pca_testing.html">PCA Testing</a>
    <a class="dropdown-item" href="../articles/quality_control.html">Quality Control Example</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/moseleybioinformaticslab/visualizationQualityControl/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>reorder by sample class</h1>
      <small class="dont-index">Source: <a href="https://github.com/moseleybioinformaticslab/visualizationQualityControl/blob/HEAD/R/heatmaps.R" class="external-link"><code>R/heatmaps.R</code></a></small>
      <div class="d-none name"><code>similarity_reorderbyclass.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>to avoid spurious visualization problems, it is useful in a heatmap visualization
to reorder the samples within each sample class. This function uses 
hierarchical clustering and dendsort to sort entries in a distance matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">similarity_reorderbyclass</span><span class="op">(</span>
  <span class="va">similarity_matrix</span>,
  sample_classes <span class="op">=</span> <span class="cn">NULL</span>,
  transform <span class="op">=</span> <span class="st">"none"</span>,
  hclust_method <span class="op">=</span> <span class="st">"complete"</span>,
  dendsort_type <span class="op">=</span> <span class="st">"min"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>similarity_matrix</dt>
<dd><p>matrix of similarities between objects</p></dd>
<dt>sample_classes</dt>
<dd><p>data.frame or factor denoting classes</p></dd>
<dt>transform</dt>
<dd><p>a transformation to apply to the data</p></dd>
<dt>hclust_method</dt>
<dd><p>which method for clustering should be used</p></dd>
<dt>dendsort_type</dt>
<dd><p>how should dendsort do reordering?</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list containing the reordering of the matrix in a:</p><ol><li><p>dendrogram</p></li>
<li><p>numeric vector</p></li>
<li><p>character vector (will be NULL if rownames are not set on the matrix)</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>similarity_matrix</code> should be either a square matrix of similarity values
or a distance matrix of class <code>dist</code>. If your matrix does not encode a "true"
distance, you can use a <code>transform</code> to turn it into a true <code>distance</code>
(for example, if you have correlation, then a distance would be 1 - correlation,
use "sub_1" as the transform argument).</p>
<p>The <code>sample_classes</code> should be either a data.frame or factor argument. If 
a data.frame is passed, all columns of the data.frame will be pasted together
to create a factor for splitting the data into groups. If the rownames of the
data.frame do not correspond to the rownames or colnames of the matrix, then
it is assumed that the ordering in the matrix and the data.frame are identical.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://moseleybioinformaticslab.github.io/visualizationQualityControl" class="external-link">visualizationQualityControl</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span class="r-in"><span class="va">neworder</span> <span class="op">&lt;-</span> <span class="fu">similarity_reorderbyclass</span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mat</span><span class="op">[</span><span class="va">neworder</span><span class="op">$</span><span class="va">indices</span>, <span class="va">neworder</span><span class="op">$</span><span class="va">indices</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           a         d        g        b        c        f        e        h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 1.3964671 2.5511488 2.328294 1.761404 2.067044 1.096984 2.724748 2.003446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 0.8271511 1.7493710 1.665183 2.032229 2.229795 1.492519 1.859688 2.324143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 1.7126300 0.9099802 1.430696 1.744495 2.287378 2.823909 1.446341 1.304650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 2.1387146 1.7622035 3.274496 1.500807 1.754657 1.708962 1.465679 1.772266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 2.5422206 1.6452800 1.982620 1.611873 1.779726 1.445555 1.572318 1.816738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 2.2530279 1.4161904 2.888542 1.944857 1.275898 2.281528 1.515743 1.923301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 2.2145623 1.1854533 1.996198 2.479747 1.653140 1.918845 1.502830 3.035135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 1.7266841 1.3295034 2.683914 1.544402 1.488172 1.613323 1.374007 1.638209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 1.7177740 1.8528531 2.664782 1.581414 1.992431 2.802955 1.738086 2.129131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 1.5549811 1.7670512 2.168236 3.207918 1.532026 1.421096 1.751575 1.841470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          i        j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 1.911105 1.973421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.913106 2.500757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 2.274999 1.432696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 1.915003 2.127598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.313849 2.852982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 2.348804 2.177775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 2.425116 1.752208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 1.798634 2.439102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 1.904203 2.486458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 1.402736 3.060559</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">sample_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grp1"</span>, <span class="st">"grp2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sample_class</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span class="r-in"><span class="va">neworder2</span> <span class="op">&lt;-</span> <span class="fu">similarity_reorderbyclass</span><span class="op">(</span><span class="va">mat</span>, <span class="va">sample_class</span><span class="op">[</span>, <span class="st">"grp"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># if there is a class with only one member, it is dropped, with a warning</span></span>
<span class="r-in"><span class="va">sample_class</span><span class="op">[</span><span class="fl">10</span>, <span class="st">"grp"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"grp3"</span></span>
<span class="r-in"><span class="va">neworder3</span> <span class="op">&lt;-</span> <span class="fu">similarity_reorderbyclass</span><span class="op">(</span><span class="va">mat</span>, <span class="va">sample_class</span><span class="op">[</span>, <span class="st">"grp"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removing groups: grp3</span>
<span class="r-in"><span class="va">neworder3</span><span class="op">$</span><span class="va">indices</span> <span class="co"># 10 should be missing</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 4 5 2 3 6 8 7 9</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mat</span><span class="op">[</span><span class="va">neworder2</span><span class="op">$</span><span class="va">indices</span>, <span class="va">neworder2</span><span class="op">$</span><span class="va">indices</span><span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           a         d        e        b        c        i        j        g</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 1.3964671 2.5511488 2.724748 1.761404 2.067044 1.911105 1.973421 2.328294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 0.8271511 1.7493710 1.859688 2.032229 2.229795 1.913106 2.500757 1.665183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 2.2145623 1.1854533 1.502830 2.479747 1.653140 2.425116 1.752208 1.996198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 2.1387146 1.7622035 1.465679 1.500807 1.754657 1.915003 2.127598 3.274496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 2.5422206 1.6452800 1.572318 1.611873 1.779726 1.313849 2.852982 1.982620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 1.7177740 1.8528531 1.738086 1.581414 1.992431 1.904203 2.486458 2.664782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 1.5549811 1.7670512 1.751575 3.207918 1.532026 1.402736 3.060559 2.168236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 1.7126300 0.9099802 1.446341 1.744495 2.287378 2.274999 1.432696 1.430696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 2.2530279 1.4161904 1.515743 1.944857 1.275898 2.348804 2.177775 2.888542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 1.7266841 1.3295034 1.374007 1.544402 1.488172 1.798634 2.439102 2.683914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          f        h</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 1.096984 2.003446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d 1.492519 2.324143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e 1.918845 3.035135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 1.708962 1.772266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c 1.445555 1.816738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i 2.802955 2.129131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j 1.421096 1.841470</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g 2.823909 1.304650</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f 2.281528 1.923301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h 1.613323 1.638209</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">neworder</span><span class="op">$</span><span class="va">names</span>, <span class="va">neworder2</span><span class="op">$</span><span class="va">names</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] "a"  "a" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] "d"  "d" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] "g"  "e" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] "b"  "b" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] "c"  "c" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] "f"  "i" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] "e"  "j" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] "h"  "g" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] "i"  "f" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] "j"  "h" </span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robert M Flight, Hunter NB Moseley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

